!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.blobUtil={})}(this,function(e){"use strict";function n(e,n){return new Promise(function(r,t){var o=new Image;n&&(o.crossOrigin=n),o.onload=function(){r(o)},o.onerror=t,o.src=e})}function r(e){var n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,e.width,e.height),n}function t(e,n){e=e||[],"string"==typeof(n=n||{})&&(n={type:n});try{return new Blob(e,n)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),t=0;t<e.length;t+=1)r.append(e[t]);return r.getBlob(n.type)}}function o(e){return new Promise(function(n,r){var t=new FileReader,o="function"==typeof t.readAsBinaryString;t.onloadend=function(){var e=t.result||"";if(o)return n(e);n(c(e))},t.onerror=r,o?t.readAsBinaryString(e):t.readAsArrayBuffer(e)})}function i(e,n){var r=[d(atob(e))];return n?t(r,{type:n}):t(r)}function u(e){return o(e).then(btoa)}function a(e){var n=e.match(/data:([^;]+)/)[1],r=e.replace(/^[^,]+,/,"");return t([d(atob(r))],{type:n})}function f(e,n,r){return"function"==typeof e.toBlob?new Promise(function(t){e.toBlob(t,n,r)}):Promise.resolve(a(e.toDataURL(n,r)))}function c(e){for(var n="",r=new Uint8Array(e),t=r.byteLength,o=-1;++o<t;)n+=String.fromCharCode(r[o]);return n}function d(e){for(var n=e.length,r=new ArrayBuffer(n),t=new Uint8Array(r),o=-1;++o<n;)t[o]=e.charCodeAt(o);return r}e.createBlob=t,e.createObjectURL=function(e){return("undefined"!=typeof URL?URL:webkitURL).createObjectURL(e)},e.revokeObjectURL=function(e){return("undefined"!=typeof URL?URL:webkitURL).revokeObjectURL(e)},e.blobToBinaryString=o,e.base64StringToBlob=i,e.binaryStringToBlob=function(e,n){return i(btoa(e),n)},e.blobToBase64String=u,e.dataURLToBlob=a,e.blobToDataURL=function(e){return u(e).then(function(n){return"data:"+e.type+";base64,"+n})},e.imgSrcToDataURL=function(e,t,o,i){return t=t||"image/png",n(e,o).then(r).then(function(e){return e.toDataURL(t,i)})},e.canvasToBlob=f,e.imgSrcToBlob=function(e,t,o,i){return t=t||"image/png",n(e,o).then(r).then(function(e){return f(e,t,i)})},e.arrayBufferToBlob=function(e,n){return t([e],n)},e.blobToArrayBuffer=function(e){return new Promise(function(n,r){var t=new FileReader;t.onloadend=function(){var e=t.result||new ArrayBuffer(0);n(e)},t.onerror=r,t.readAsArrayBuffer(e)})},e.arrayBufferToBinaryString=c,e.binaryStringToArrayBuffer=d,Object.defineProperty(e,"__esModule",{value:!0})});